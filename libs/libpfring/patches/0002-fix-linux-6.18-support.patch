--- a/kernel/pf_ring.c
+++ b/kernel/pf_ring.c
@@ -5401,7 +5401,11 @@
   debug_printk(1, "checking promisc for %s\n", netdev->name);
 
   rtnl_lock();
+#if LINUX_VERSION_CODE < KERNEL_VERSION(6,18,0)
   if_flags = (short) dev_get_flags(netdev);
+#else
+  if_flags = (short) netif_get_flags(netdev);
+#endif
   rtnl_unlock();
 
   return !!(if_flags & IFF_PROMISC);
@@ -5416,7 +5420,11 @@
 
   rtnl_lock();
 
+#if LINUX_VERSION_CODE < KERNEL_VERSION(6,18,0)
   if_flags = (short) dev_get_flags(netdev);
+#else
+  if_flags = (short) netif_get_flags(netdev);
+#endif
   if(!(if_flags & IFF_PROMISC)) {
     if_flags |= IFF_PROMISC;
 #if(LINUX_VERSION_CODE < KERNEL_VERSION(5,0,0) && \
@@ -5439,7 +5447,11 @@
 
   rtnl_lock();
 
+#if LINUX_VERSION_CODE < KERNEL_VERSION(6,18,0)
   if_flags = (short) dev_get_flags(netdev);
+#else
+  if_flags = (short) netif_get_flags(netdev);
+#endif
   if(if_flags & IFF_PROMISC) {
     if_flags &= ~IFF_PROMISC;
 #if(LINUX_VERSION_CODE < KERNEL_VERSION(5,0,0) && \
